---

- name: Check kfilt version
  shell: 'kfilt --version | cut -f1 -d " "'
  register: kfilt_version_client_installed
  changed_when: false
  failed_when: false


- name: GitVersion
  set_fact:
    kfilt_version_installed: "{{kfilt_version_client_installed.stdout}}"

# - name: GitVersion
#   debug:
#     msg: "{{ kfilt_version_installed }}"

# https://kubernetes.io/releases/
- name: Download and unarchive kfilt
  get_url:
    url: "https://github.com/ryane/kfilt/releases/download/v{{ kfilt_version }}/kfilt_{{ kfilt_version }}_{{ kfilt_os }}_{{ kfilt_arch }}"
    dest: "{{ kfilt_bin_path }}/kfilt"
    remote_src: true
    mode: 0755
  when:
    - kfilt_version != kfilt_version_installed

